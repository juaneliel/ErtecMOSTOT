<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition template="/templates/layout.xhtml"
 xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
      
<ui:define name="cuerpo"> 
  	
  	<h:form id="formfuncionarios" enctype="multipart/form-data">
  	
  


  	
		<p:dataTable var="funcionario" value="#{mb_Funcionario.lista}" id="datatable2" emptyMessage="Sin Registros"
		 paginator="true" rows ="50" resizableColumns="true" liveResize="true" draggableColumns="true" 
		 scrollable="true" scrollHeight="500"   scrollWidth="100%"  
		 editable="true" 
		 style="text-align:left; font-size: 90% !important;color: red;font-weight: bold;"		
		 selection="#{mb_Funcionario.funcionarioSelected}" selectionMode="single" rowKey="#{funcionario.funcionarioID}"
		 paginatorTemplate=" {titulo} {CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters} {agregar} {vercol}"
    
		 
		 >
		 
		 	<f:facet name="{titulo}">
		        Funcionarios		 		        
		    </f:facet>
		 
		 <f:facet name="{vercol}">   
		    <p:commandButton id="toggler" type="button" value="Ver Columnas" style="float:right" icon="ui-icon-calculator" />
		        <p:columnToggler datasource="datatable2" trigger="toggler" >
		        	<p:ajax event="toggle" listener="#{mb_Usuario.onToggleFuncionarios}" />
		        </p:columnToggler> 
		    </f:facet> 
		    
		  <f:facet name="{agregar}">    
		 <p:commandButton value="Agregar" ajax="false" action="/paginas/addfuncionarios.xhtml?faces-redirect=true" style="float:left"/>   
      </f:facet>
		 
		 <p:ajax event="rowEdit" listener="#{mb_Funcionario.onRowEdit}" update="message" />
	 
	 
	 	<f:facet name="{Exporters}">
	    <h:commandLink>
	      <p:graphicImage name="/images/excel.png" width="24"/>
	      <p:dataExporter type="xls" target="datatable2" fileName="articulos"   />
	    </h:commandLink>	
	    <h:commandLink>
	      <p:graphicImage name="/images/pdf.png" width="24"/>
	      <p:dataExporter type="pdf" target="datatable2" fileName="articulos"  />
	    </h:commandLink> 
		</f:facet>
	 

		 
			<p:column headerText="Id" visible="#{mb_Usuario.viewFuncionarios[0]}" style = "width:50px;text-align:center" filterStyle="width: 40px;" sortBy="#{funcionario.funcionarioID}"  filterMatchMode="contains" filterBy="#{funcionario.funcionarioID}">
		        <h:outputText  value="#{funcionario.funcionarioID}"/>
		    </p:column>
		  		 
		 
			<p:column headerText="Nombre:" visible="#{mb_Usuario.viewFuncionarios[1]}" sortBy="#{funcionario.nombre}"  filterMatchMode="contains" filterBy="#{funcionario.nombre}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.nombre}" /></f:facet>
	               <f:facet name="input"><p:inputText id="nombre" value="#{funcionario.nombre}" style="width:100%;min-width:120px;"/></f:facet>
           		</p:cellEditor>
		    </p:column>
		 
		 
			<p:column headerText="Email:" visible="#{mb_Usuario.viewFuncionarios[2]}" sortBy="#{funcionario.email}"  filterMatchMode="contains" filterBy="#{funcionario.email}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.email}" /></f:facet>
	               <f:facet name="input"><p:inputText id="email" value="#{funcionario.email}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column>
	   
		    
			<p:column headerText="Telefono:"  visible="#{mb_Usuario.viewFuncionarios[3]}" sortBy="#{funcionario.telefono}"  filterMatchMode="contains" filterBy="#{funcionario.telefono}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.telefono}" /></f:facet>
	               <f:facet name="input"><p:inputText id="tel" value="#{funcionario.telefono}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column>
	   
	   
				<p:column headerText="Activo"  visible="#{mb_Usuario.viewFuncionarios[4]}" sortBy="#{funcionario.activo}"  filterMatchMode="contains" filterBy="#{funcionario.activo}">		                
		        <p:cellEditor>
	              <f:facet name="output"><h:outputText value="#{funcionario.activo}" /></f:facet>
	              <f:facet name="input">
	              	<p:selectOneMenu id="activo" value="#{funcionario.activo}" style="width:85%">
										<f:selectItem  itemLabel="Si" itemValue="Si" />
										<f:selectItem   itemLabel="No" itemValue="No" />
									</p:selectOneMenu>		               
	              </f:facet>
           		</p:cellEditor>
		    </p:column>   

				<p:column headerText="Alias"  visible="#{mb_Usuario.viewFuncionarios[5]}" sortBy="#{funcionario.alias}"  filterMatchMode="contains" filterBy="#{funcionario.alias}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.alias}" /></f:facet>
	               <f:facet name="input"><p:inputText id="alias" value="#{funcionario.alias}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column>   
	   
	   
	   		<p:column headerText="Area"  visible="#{mb_Usuario.viewFuncionarios[6]}" sortBy="#{funcionario.area}"  filterMatchMode="contains" filterBy="#{funcionario.area}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.area}" /></f:facet>
	               <f:facet name="input"><p:inputText id="area" value="#{funcionario.area}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column> 
	   
	   		<p:column headerText="Cat:"  visible="#{mb_Usuario.viewFuncionarios[7]}" sortBy="#{funcionario.cat}"  filterMatchMode="contains" filterBy="#{funcionario.cat}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.cat}" /></f:facet>
	               <f:facet name="input"><p:inputText id="cat" value="#{funcionario.cat}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column> 
		    
		    
	   		<p:column headerText="Direccion:"  visible="#{mb_Usuario.viewFuncionarios[8]}" sortBy="#{funcionario.direccion}"  filterMatchMode="contains" filterBy="#{funcionario.direccion}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.direccion}" /></f:facet>
	               <f:facet name="input"><p:inputText id="direccion" value="#{funcionario.direccion}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column> 
		    	    
		    	    
	       		   
				<p:column headerText="Nacimiento:"  visible="#{mb_Usuario.viewFuncionarios[9]}" style="min-width:100px;"  sortBy="#{funcionario.nacimiento}"  filterMatchMode="contains" filterBy="#{funcionario.nacimiento}">		                
				   <p:cellEditor>
				         <f:facet name="output">
				         	<p:calendar mindate="#{funcionario.nacimiento}" maxdate="#{funcionario.nacimiento}" id="nacimiento" value="#{funcionario.nacimiento}"
				          pattern="dd-MM-yyyy" mask="true" />
						</f:facet>
				         <f:facet name="input"> <p:calendar id="nacimientoin" value="#{funcionario.nacimiento}" pattern="dd-MM-yyyy" mask="true" />
		 				</f:facet>
					</p:cellEditor>
				</p:column>	    
				    	    
				<p:column headerText="C.Salud"  visible="#{mb_Usuario.viewFuncionarios[10]}" style="min-width:100px;"  sortBy="#{funcionario.carneSalud}"  filterMatchMode="contains" filterBy="#{funcionario.carneSalud}">		                
				   <p:cellEditor>
				         <f:facet name="output">
				         	<p:calendar mindate="#{funcionario.carneSalud}" maxdate="#{funcionario.carneSalud}" id="carneSaludout" value="#{funcionario.carneSalud}"
				          pattern="dd-MM-yyyy" mask="true" />
						</f:facet>
				         <f:facet name="input"> <p:calendar id="carneSaludin" value="#{funcionario.carneSalud}" pattern="dd-MM-yyyy" mask="true" />
		 				</f:facet>
					</p:cellEditor>
				</p:column>	     

		 
		 
		
	   		<p:column headerText="Cedula"  visible="#{mb_Usuario.viewFuncionarios[11]}" sortBy="#{funcionario.cedula}"  filterMatchMode="contains" filterBy="#{funcionario.cedula}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.cedula}" /></f:facet>
	               <f:facet name="input"><p:inputText id="Cedula" value="#{funcionario.cedula}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column> 
		
		
		
		<p:column headerText="V.Cedula"  visible="#{mb_Usuario.viewFuncionarios[12]}" style="min-width:100px;"  sortBy="#{funcionario.vencimientoCedula}"  filterMatchMode="contains" filterBy="#{funcionario.vencimientoCedula}">		                
				   <p:cellEditor>
				         <f:facet name="output">
				         	<p:calendar mindate="#{funcionario.vencimientoCedula}" maxdate="#{funcionario.vencimientoCedula}" id="vcedulaout" value="#{funcionario.vencimientoCedula}"
				          pattern="dd-MM-yyyy" mask="true" />
						</f:facet>
				         <f:facet name="input"> <p:calendar id="vcedulain" value="#{funcionario.vencimientoCedula}" pattern="dd-MM-yyyy" mask="true" />
		 				</f:facet>
					</p:cellEditor>
				</p:column>	    	
		
		
	   		<p:column headerText="Cat.Libreta"  visible="#{mb_Usuario.viewFuncionarios[13]}" sortBy="#{funcionario.libretaCat}"  filterMatchMode="contains" filterBy="#{funcionario.libretaCat}">		                
		        <p:cellEditor>
	               <f:facet name="output"><h:outputText value="#{funcionario.libretaCat}" /></f:facet>
	               <f:facet name="input"><p:inputText id="CatLibreta" value="#{funcionario.libretaCat}" style="width:100%"/></f:facet>
           		</p:cellEditor>
		    </p:column> 
		
		 
		 
				<p:column headerText="V.Libreta"  visible="#{mb_Usuario.viewFuncionarios[14]}" style="min-width:100px;"  sortBy="#{funcionario.vencimientoLibreta}"  filterMatchMode="contains" filterBy="#{funcionario.vencimientoLibreta}">		                
				   <p:cellEditor>
				         <f:facet name="output">
				         	<p:calendar mindate="#{funcionario.vencimientoLibreta}" maxdate="#{funcionario.vencimientoLibreta}" id="vlibretaout" value="#{funcionario.vencimientoLibreta}"
				          pattern="dd-MM-yyyy" mask="true" />
						</f:facet>
				         <f:facet name="input"> <p:calendar id="vlibretain" value="#{funcionario.vencimientoLibreta}" pattern="dd-MM-yyyy" mask="true" />
		 				</f:facet>
					</p:cellEditor>
				</p:column>	    
		 
		 
	 
		 
		 		   <p:column toggleable="false" headerText="Edit"  style = "width:20px" rendered="#{mb_Usuario.acceso('EDITAR',mb_Usuario.funcionarios)}" exportable="false">						
					<p:rowEditor >
					</p:rowEditor>									
		    </p:column>
		     
		    <p:column toggleable="false" headerText="Bor"  style = "width:20px"  rendered="#{mb_Usuario.acceso('BORRAR',mb_Usuario.funcionarios)}" exportable="false">			
			<p:commandLink actionListener="#{mb_Funcionario.delete(funcionario)}"    	
   	update="formfuncionarios message" >
        <p:confirm header="Confirmacion" message="Borrar a #{funcionario.nombre}?" icon="ui-icon-alert" />
  <span class="ui-icon ui-icon-trash"></span>
   	</p:commandLink>    
    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
        <p:commandButton value="Borrar" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" oncomplete="processWidget.clearFilters();" />
        <p:commandButton value="Cancelar" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
    </p:confirmDialog>
			</p:column>
		 
		 
		 
		 
 
		    	   
		      
		</p:dataTable>
		
			<p:contextMenu for="datatable2" id="contextmenu" beforeShow="return true;" widgetVar="contextmenu"  >
   	<p:menuitem id="dale" update="dialficha" value="Exportar Ficha"  icon="ui-icon-search" oncomplete="PF('dialficha').show()"  />   	
  	<p:menuitem value="Detalles" update="detalles" icon="ui-icon-search" oncomplete="PF('dialogodetalles').show()"/>
		<p:menuitem value="Subir Archivo" update="subirarchivo" icon="ui-icon-search" oncomplete="PF('subirarchivo').show()"/>
		
		</p:contextMenu>



<script type="text/javascript"> 
    function exportarPDF() {
    	window.open('#{mb_Funcionario.urlImpresion}','','width=500,height=500');
    }
</script>




  	</h:form>

 
<p:dialog id="dialficha"  widgetVar="dialficha" showEffect="explode" hideEffect="fade"  modal="true"  onHide="jQuery('#someId').hide();" onShow="jQuery('#someId').show();" dynamic="true"  width="80%" height="500"  >
    <iframe frameborder="0" align="left"
         src="#{mb_Funcionario.urlImprimirFun()}"
         name="someName" id="someId" scrolling="auto" width="100%" height="100%" >
     </iframe>
</p:dialog>

 


<p:dialog id="subirarchivo"  widgetVar="subirarchivo" showEffect="explode" hideEffect="fade"  modal="true"   dynamic="true"  width="600" height="300"  >
 <h:form>
           <h:outputLabel for="txtIdName" value="Nombre archivo:" />
            <p:inputText id="txtIdName" required="true" value="#{mb_Funcionario.nombreArchivo}"   label="Name" />
 
            <br/>
            <h:outputLabel for="fileIdPhoto" value="sube archivo:" /> 
            <p:fileUpload id="fileIdPhoto"  fileUploadListener="#{mb_Funcionario.upload}" mode="advanced" dragDropSupport="false" label="Elegir" uploadLabel="Guardar" cancelLabel="Cancelar"
             multiple="false" ajax="false" update="message" sizeLimit="10000000" fileLimit="3" allowTypes="/(\.|\/)(gif|jpe?g|zip|png|pdf)$/"  />
 
    <p:commandButton value="Submit" ajax="true" action="#{mb_Funcionario.getNombreArchivo}"/>   
 
 </h:form> 


</p:dialog>




<p:dialog header="Detalle funcionario" widgetVar="dialogodetalles" modal="true" showEffect="explode" hideEffect="fade" dynamic="true" >
        <p:outputPanel id="detalles" style="text-align:center;">
                <p:panelGrid  columns="2"  columnClasses="label,value" rendered="#{mb_Funcionario.funcionarioSelected!=null}">
                 
                <h:outputText value="Id:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.funcionarioID}" />
 
                <h:outputText value="Nombre:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.nombre}" />
 
                <h:outputText value="Email:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.email}" style="color:blue"/>
 
                <h:outputText value="Telefono:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.telefono}" />
 
                <h:outputText value="Activo:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.activo}" />

                <h:outputText value="Alias:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.alias}" />

                <h:outputText value="Area:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.area}" />
                
                <h:outputText value="Categoria:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.cat}" />                 
                
                <h:outputText value="Direccion:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.direccion}" />

                <h:outputText value="Nacimiento:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.nacimiento}" />
                
                <h:outputText value="C.Salud" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.carneSalud}" /> 
                
                
                
                <h:outputText value="Cedula:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.cedula}" /> 
                   
                <h:outputText value="V.Cedula:" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.vencimientoCedula}" /> 
                   
                <h:outputText value="C.Libreta" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.libretaCat}" /> 
               
                
                <h:outputText value="V.Libreta" />
                <h:outputText value="#{mb_Funcionario.funcionarioSelected.vencimientoLibreta}" /> 
               

            </p:panelGrid>
        </p:outputPanel>
    </p:dialog>


</ui:define>
</ui:composition>


<!--   <f:event type="preRenderView" listener="#{mb_Reclamo.recargar}" /> -->

<!--   <p:ajax event="rowSelect" listener="#{mb_Reclamo.onRowReclamoSelect}" update=":formreclamo:detalles" oncomplete="PF('dialogodetalles').show()" /> -->
 

<!-- 	 <p:ajax event="rowSelect" listener="#{mb_Funcionario.onRowSelect}" update=":formfuncionarios:detalles" oncomplete="PF('dialogodetalles').show()" /> -->
   
		
		
		
		
		
<!-- <p:fileUpload label="Elegir" uploadLabel="Guardar" cancelLabel="Cancelar" fileUploadListener="#{mb_Funcionario.upload}" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" sizeLimit="100000000" description="Seleccione el archivo"/> -->
<!-- <h:graphicImage value="/resources/fotos/c.png" height="100" width="100"/> -->
		
		
 
<!--     <p:ajax event="contextMenu" process="datatable2"   update="@([id$=contextmenu])" onclick="PF('contextmenu').show();" /> -->
 		
