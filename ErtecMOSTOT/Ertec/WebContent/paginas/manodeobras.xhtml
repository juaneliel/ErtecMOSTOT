<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition template="/templates/layout.xhtml"
 xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
      

<ui:define name="cuerpo">   	 
 
 	
<h:form id="datatableMO">



<p:outputLabel for="maskIni" value="Fecha inicial:" />
<p:calendar id="maskIni" value="#{mb_ManoObra.fechaIni}" pattern="dd-MM-yyyy" mask="true"  effect="fold" />
 

<p:outputLabel for="maskFin" value="  Fecha final:" />
<p:calendar id="maskFin" value="#{mb_ManoObra.fechaFin}" pattern="dd-MM-yyyy" mask="true" effect="fold" />
 
<p:commandButton value="Buscar"  icon="ui-icon-trash" id="Buscar" action="#{mb_ManoObra.filtrarPorFechas}"   
update="datatable2MO :message"/>
			 




<p:dataTable var="mo" value="#{mb_ManoObra.lista}" id="datatable2MO" 
 paginator="true" rows ="50" paginatorPosition="top" resizableColumns="true" liveResize="true" 
 draggableColumns="true" scrollable="true"  
 scrollWidth="100%"  scrollHeight="500" editable="true"
  style="text-align:left;font-size: 90% !important;color: red;font-weight: bold;"
			
 	paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                 
		 >
			<f:facet name="{Exporters}">
            <h:commandLink>
                <p:graphicImage name="/images/excel.png" width="24"/>
                <p:dataExporter type="xls" target="datatable2MO" fileName="manoobra" />
            </h:commandLink>
 
            <h:commandLink>
                <p:graphicImage name="/images/pdf.png" width="24"/>
                <p:dataExporter type="pdf" target="datatable2MO" fileName="manoobra"/>
            </h:commandLink> 
			</f:facet>

 
 	<f:facet name="header">
        Mano de obra 
        <p:commandButton id="toggler" type="button" value="Elegir Columnas" style="float:right" icon="ui-icon-calculator" />
        <p:columnToggler datasource="datatable2MO" trigger="toggler" />
    </f:facet>   
   
    
  <p:ajax event="rowEdit" listener="#{mb_ManoObra.onRowEdit}" update="message" />
	<p:ajax event="rowEditInit" listener="#{mb_ManoObra.clickEdit(mo)}" update="message" />
	
		

		<p:column headerText="ID" sortBy="#{mo.manoObraID}"  filterMatchMode="contains" filterBy="#{mo.manoObraID}">		                
		   <h:outputText value="#{mo.manoObraID}" />
		</p:column>
		 
		 
		 
		<p:column headerText="Clliente:" style="min-width:140px;" sortBy="#{mo.clienteNombre}"  filterMatchMode="contains" filterBy="#{mo.clienteNombre}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.clienteNombre}" /></f:facet>
		         <f:facet name="input">
		         <p:autoComplete  id="cliente" value="#{mo.cliente}"
 							completeMethod="#{mb_Cliente.completarCliente}" 
							var="theme" itemLabel="#{theme.nombre}" itemValue="#{theme}"
 							converter="ConverterCliente" forceSelection="true" 
 							style="float:left !important;margin:0px 0px 3px 0px;"/> 		         
			     </f:facet>
			</p:cellEditor>
		</p:column> 
    
 




		<p:column headerText="Funcionario Nombre:" style="min-width:140px;" sortBy="#{mo.funcionario.nombre}"  filterMatchMode="contains" filterBy="#{mo.funcionario.nombre}">		                
		   <p:cellEditor>
		   	<f:facet name="output"><h:outputText value="#{mo.funcionario.nombre}" /></f:facet>
		    <f:facet name="input">
					<p:autoComplete id="funcionario" value="#{mo.funcionario}"
					 	completeMethod="#{mb_Funcionario.completarFuncionario}"
						var="theme" itemLabel="#{theme.nombre}" itemValue="#{theme}"
					 	converter="ConverterFuncionario" forceSelection="true" 
					  style="float:left !important;margin:0px 0px 3px 0px;"
					  queryDelay="1000" 
					  /> 
				</f:facet>
			</p:cellEditor>
		</p:column>
		
				
		
		
		<p:column headerText="N Contrato:" sortBy="#{mo.NContrato}"  filterMatchMode="contains" filterBy="#{mo.NContrato}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.NContrato}" /></f:facet>
		         <f:facet name="input"><p:inputText id="NContrato" value="#{mo.NContrato}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>

    
    		<p:column headerText="Codigo:" sortBy="#{mo.codigo}"  filterMatchMode="contains" filterBy="#{mo.codigo}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.codigo}" /></f:facet>
		         <f:facet name="input">
					<p:selectOneMenu value="#{mo.codigo}" style="width:100%">
                       <f:selectItems value="#{mb_ManoObra.listaCodMO}" var="cmo" 
                       itemLabel="#{cmo.descripcion}" itemValue="#{cmo.codigo}" />
                   </p:selectOneMenu>
		         </f:facet>
			</p:cellEditor>
		</p:column>
    
 
	       		   
		<p:column headerText="Fecha:" style="min-width:100px;"  sortBy="#{mo.fecha}"  filterMatchMode="contains" filterBy="#{mo.fecha}">		                
		   <p:cellEditor>
		         <f:facet name="output">
		         	<p:calendar mindate="#{mo.fecha}" maxdate="#{mo.fecha}" id="maskout" value="#{mo.fecha}"
		          pattern="dd-MM-yyyy" mask="true" />
				</f:facet>
		         <f:facet name="input"> <p:calendar id="maskin" value="#{mo.fecha}" pattern="dd-MM-yyyy" mask="true" />
 				</f:facet>
			</p:cellEditor>
		</p:column>
	       		   
 
		<p:column headerText="MYR" sortBy="#{mo.myr}"  filterMatchMode="contains" filterBy="#{mo.myr}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.myr}" /></f:facet>
		         <f:facet name="input"><p:inputText id="MYR" value="#{mo.myr}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>

	 
       			<p:column headerText="O.T.:" sortBy="#{mo.ordenTrabajo}"  filterMatchMode="contains" filterBy="#{mo.ordenTrabajo}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.ordenTrabajo}" /></f:facet>
		         <f:facet name="input"><p:inputText id="ot" value="#{mo.ordenTrabajo}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
       	


    
     
     		<p:column headerText="T. Contrato" sortBy="#{mo.TContrato}"  filterMatchMode="contains" filterBy="#{mo.TContrato}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.TContrato}" /></f:facet>
		         <f:facet name="input"><p:inputText id="tcon" value="#{mo.TContrato}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
    
    		<p:column headerText="Tipo:" sortBy="#{mo.tipo}"  filterMatchMode="contains" filterBy="#{mo.tipo}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.tipo}" /></f:facet>
		         <f:facet name="input"><p:inputText id="tipo" value="#{mo.tipo}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
    
     
    
    		<p:column headerText="Tipo Hora" sortBy="#{mo.tipoHora}"  filterMatchMode="contains" filterBy="#{mo.tipoHora}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.tipoHora}" /></f:facet>
		         <f:facet name="input"><p:inputText id="thora" value="#{mo.tipoHora}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
    
     
    
    		<p:column headerText="Tipo Mano" sortBy="#{mo.tipoMano}"  filterMatchMode="contains" filterBy="#{mo.tipoMano}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.tipoMano}" /></f:facet>
		         <f:facet name="input"><p:inputText id="tmano" value="#{mo.tipoMano}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
    
     
    		<p:column headerText="Total Horas" sortBy="#{mo.totalHora}"  filterMatchMode="contains" filterBy="#{mo.totalHora}">		                
		   <p:cellEditor>
		         <f:facet name="output"><h:outputText value="#{mo.totalHora}" /></f:facet>
		         <f:facet name="input"><p:inputText id="total" value="#{mo.totalHora}" style="width:100%"/></f:facet>
			</p:cellEditor>
		</p:column>
    
    		    
 		   <p:column toggleable="false" headerText="Edit"  style = "width:20px" rendered="#{mb_Usuario.acceso('EDITAR',mb_Usuario.manodeobra)}"  exportable="false">					
					<p:rowEditor >
					</p:rowEditor>									
		    </p:column>
		     
		    <p:column toggleable="false" headerText="Bor"  style = "width:20px"  rendered="#{mb_Usuario.acceso('BORRAR',mb_Usuario.manodeobra)}"  exportable="false">		
			<p:commandLink actionListener="#{mb_ManoObra.delete(mo)}" 
   	
   	update="datatable2MO message" >
        <p:confirm header="Confirmacion" message="Borrar Mano de Obra de #{mo.funcionario.nombre}?" icon="ui-icon-alert" />
  <span class="ui-icon ui-icon-trash"></span>
   	</p:commandLink>    
    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
        <p:commandButton value="Borrar" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" oncomplete="processWidget.clearFilters();" />
        <p:commandButton value="Cancelar" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
    </p:confirmDialog>
			</p:column>
		    
		     
		     
 
		     
		    
		    
		    	   

    
</p:dataTable>   


</h:form>

 
</ui:define>


</ui:composition>



 
<!-- 		<p:column headerText="Funcionario ID:" sortBy="#{mo.funcionarioID}"  filterMatchMode="contains" filterBy="#{mo.funcionarioID}">		                 -->
<!-- 		   <p:cellEditor> -->
<!-- 		         <f:facet name="output"><h:outputText value="#{mo.funcionarioID}" /></f:facet> -->
<!-- 		         <f:facet name="input"><p:inputText id="funcionario" value="#{mo.funcionarioID}" style="width:100%"/></f:facet> -->
<!-- 			</p:cellEditor> -->
<!-- 		</p:column> -->
		

<!-- <f:event type="preRenderView" listener="#{mb_ManoObra.recargarLista}" /> -->
